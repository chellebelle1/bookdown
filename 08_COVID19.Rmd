# Parameterized COVID-19 report 

Parameterized reporting is a technique that allows you to generate multiple reports simultaneously. By using parameterized reporting, you can follow the same process to make 3,000 reports as you would to make one report. The technique also makes your work more accurate, as it avoids copy-and-paste errors.

In this chapter we're making a parameterized report of COVID-19 data obtained from the European Center for Disease Control (ECDC). 


## Importeren en inspecteren {-}
```{r, echo=F, message=F}
library(readr)
# importeren data
covid_data <- read_csv("~/Rachelle/data.csv")

library(reactable)
reactable(covid_data, defaultPageSize =10, compact = TRUE)
```

## Lijngrafiek Nederland, Frankrijk en Spanje {-}
Met de ECDC COVID-19 gegevens is er een visuele weergave van COVID-19 cases en deaths in geselecteerde landen en jaargetallen. De grafieken tonen het aantal cases en deaths per datum. Door gebruik te maken van parametrisatie in de R-code met `params$`, kan dit rapport eenvoudig aangepast worden aan specifieke interesses zonder dat je de onderliggende code hoeft te wijzigen.
```{r, echo=F, message=F, fig.cap= "Lijngrafiek van COVID-19 data, waarbij de datum in jaar en maand op de x-as staat, de aantal cases op de y-as. Verschillende kleuren vertegenwoordigen geselecteerde landen Nederland, Germany en Belgium"}

library(ggplot2)

# parameters
param <- list(
  selecteer_land= c('Netherlands', 'Germany', 'Belgium'),
  selecteer_jaar= 2020
)

# converteer dateRep naar het Date-type
covid_data$dateRep <- as.Date(covid_data$dateRep, format='%d/%m/%Y')

# filter de data voor geselecteerde landen
selecteer_data <- subset(covid_data, countriesAndTerritories %in% param$selecteer_land & format(dateRep, "%Y") == param$selecteer_jaar)

# aggregeer de data per datum en land
agg_data <- aggregate(cbind(cases, deaths) ~ dateRep + countriesAndTerritories, data=selecteer_data, sum)

# grafiek cases
cases_plot <- ggplot(agg_data, aes(x=dateRep, y=cases, color=countriesAndTerritories)) +
  geom_line() +
  labs(title=paste('COVID-19 cases in geselecteerde landen in tijd', param$selecteer_jaar), x='Datum', y='Aantal cases') +
  theme_minimal()

# grafiek deaths
deaths_plot <- ggplot(agg_data, aes(x=dateRep, y=deaths, color=countriesAndTerritories)) +
  geom_line() +
  labs(title=paste('COVID-19 deaths in geselecteerde landen in tijd', param$selecteer_jaar), x='Datum', y='Aantal cases') +
  theme_minimal()

# plot grafieken
print(cases_plot)
print(deaths_plot)

```

## Lijngrafiek Roemenië, Noorwegen en Italië {-}
Om te controleren of de parametrisatie correct functioneert, kan je de waarden in de parameterlijst aanpassen. In dit voorbeeld worden de landen Roemenië, Noorwegen en Italië gebruikt en het jaar 2021.
```{r, echo=F, message=F, fig.cap= "Lijngrafiek van COVID-19 data, waarbij de datum in jaar en maand op de x-as staat, de aantal cases op de y-as. Verschillende kleuren vertegenwoordigen geselecteerde landen Romania, Liechtenstein en Italy"}
library(ggplot2)

# parameters
param <- list(
  selecteer_land= c('Romania', 'Liechtenstein', 'Italy'),
  selecteer_jaar= 2022
)

# converteer dateRep naar het Date-type
covid_data$dateRep <- as.Date(covid_data$dateRep, format='%d/%m/%Y')

# filter de data voor geselecteerde landen
selecteer_data <- subset(covid_data, countriesAndTerritories %in% param$selecteer_land & format(dateRep, "%Y") == param$selecteer_jaar)

# aggregeer de data per datum en land
agg_data <- aggregate(cbind(cases, deaths) ~ dateRep + countriesAndTerritories, data=selecteer_data, sum)

# grafiek cases
cases_plot <- ggplot(agg_data, aes(x=dateRep, y=cases, color=countriesAndTerritories)) +
  geom_line() +
  labs(title=paste('COVID-19 cases in geselecteerde landen in tijd', param$selecteer_jaar), x='Datum', y='Aantal cases') +
  theme_minimal()

# grafiek deaths
deaths_plot <- ggplot(agg_data, aes(x=dateRep, y=deaths, color=countriesAndTerritories)) +
  geom_line() +
  labs(title=paste('COVID-19 deaths in geselecteerde landen in tijd', param$selecteer_jaar), x='Datum', y='Aantal cases') +
  theme_minimal()

# plot grafieken
print(cases_plot)
print(deaths_plot)

```

